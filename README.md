# KubeIaaS-基于K8s的轻量化虚拟机管理套件

> 本项目由 **[“自邮之翼”](http://www.free4inno.com)** 团队研发

## 产品介绍

KubeIaaS是基于Kubernetes的轻量化虚拟机管理套件，旨在充分利用Kubernetes的能力针对虚拟机应用场景进行扩展。其目标是实现：

- 调度能力一体化
- 运维能力一体化

  KubeIaaS充分利用Kubernetes的调度与运维能力优势，基于Prometheus、Grafana等云原生组件，将针对虚拟机的调度与运维能力集成到Kubernetes中。实现虚拟机资源与容器资源的调度运维一体化，打造虚拟机与容器同宿主环境下运行的融合云。

- 管控能力组件化
- 组件部署容器化

  KubeIaaS将对虚拟机的管控能力封装为Kubernetes上的应用组件，并通过容器化方式实现轻量化便捷部署。同时，将虚拟机资源与系统管控能力解耦，虚拟机的任何计算、存储、网络资源均不依赖容器集群环境，保证虚拟机能够在宿主机上独立运行。
````
~~+---------------------+~~
  | User                |
~~+---------------------+~~
  | Front               |
~~+---------------------+~~
  | KubeIaaS  | Others  |
~~+---------------------+~~
  |     | K8s           |  
  | KVM |---------------|
  |     | Docker        |  
~~+---------------------+~~
  | Physical            |
~~+---------------------+~~
````
  
## 功能概述
KubeIaaS在当前版本（v1.0）中主要实现了如下相关功能，

【图】

> 说明：灰色部分为当前版本尚未完成，但计划在未来版本中加入的功能

- 云主机（虚拟机）

云主机即虚拟机，是本系统提供的核心功能服务。您能够按需灵活配置，一键便捷创建云主机，并通过管理界面对已创建云主机资源轻松管理。系统支持对云主机的启动、停止、重启、挂起、恢复等基本操作，同时您还能够在系统内通过 Web VNC 远程连接到您的云主机进行操作。您还能够对您的云主机实现计算资源（vCPU、内存）的热更新，存储资源（数据卷）的动态挂载卸载，网络资源（私网/公网IP）的分配与调整。未来还将计划实现对云主机的监控、迁移、快照与备份的相关功能。

- 云硬盘（数据卷）

云硬盘即数据卷，能够为云主机提供额外的存储资源。您能够在系统内创建不同规格的云硬盘，对它们进行管理、编辑、删除。同时，您能够将云硬盘热挂载到具有额外数据存储需求的云主机并支持卸载，灵活易用。

- 云镜像（虚拟机镜像）

云镜像即虚拟机镜像，作为创建云主机时的基础模板。您能够将您的基础镜像上传至系统进行管理，并利用他们作为镜像模板创建云主机。同时，您还能将已经创建并配置使用过的云主机再次封装为新的镜像，一键发布。

- 系统管理

系统管理用于对系统整体进行管理、监控、运维。在首页中，您可以通过仪表卡片便捷总览系统状态。系统管理页面则提供了针对基础服务的管理能力、针对各类资源（节点计算、存储、网络）的管理能力。未来还将计划实现对节点、云主机的状态监控，并提供告警管理能力。

- 可扩展能力

KubeIaaS能够与“虎符”集成，组建“Hybrid cloUd FUsion platform”混合云平台，在同一集群内同时提供IaaS云与容器云服务。

> **“虎符”** 是自邮之翼研发团队推出的一款一站式云原生基础设施解决方案

系统内功能界面截图展示如下，

【图】

## 安装部署

- 快速启动文档：【链接】

## 技术架构

KubeIaaS 的核心架构如下，

【图】

虚拟化能力基于 KVM + Libvirt；后端利用 Spring Boot 完成各组件的开发，数据库使用 SQLite 实现容器内轻量化存储；前端采用 Vue + Element UI 开发；各组件均基于 Kubernetes 实现容器化部署。

各组件在K8s集群中的部署视图如下，

【图】

KubeIaaS 中定义了两种节点角色类型：

- 工作节点 🔧
    - 云主机将会运行在这些节点上，并利用其上的资源（例如，CPU、内存、磁盘、网卡）
- 管控节点 🔑
    - 提供对系统的管控能力（例如，数据存储、资源调度）

如图所示，左侧三个节点为工作节点，最右侧节点为管控节点。在 Kubernetes 集群上通过节点标签标记这些节点角色，以 Deployment 与 DaemonSet 的形式部署各应用组件，利用宿主节点底层基础环境，最终完成系统对虚拟机的管控。

> ⚠ 注意！IaaS-Agent 对宿主机及其上虚拟机的管控依赖 特权容器

项目目录说明如下，
```
├─ deploy             # 部署相关资源
├─ api-common         # 统一依赖包
├─ db-proxy           # 持久化模块
├─ iaas-agent         # KubeIaaS代理模块
├─ iaas-core          # KubeIaaS核心模块
├─ image-operator     # 镜像管理模块
├─ resource-operator  # 资源调度模块
```
更多详细内容请见：【链接】

## 贡献说明
本项目由[自邮之翼](http://www.free4inno.com)团队研发，指导老师为北京邮电大学[徐鹏](https://teacher.bupt.edu.cn/xupeng/zh_CN/index.htm)老师，贡献人员名单如下：
- 【人】
- 【人】
- 【人】
- 【人】